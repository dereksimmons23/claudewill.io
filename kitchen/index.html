<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>the kitchen | claudewill*</title>
  <meta name="description" content="How one person runs a consulting practice with AI. The crew, the agents, the overnight work, the whole system. Everything here is real.">

  <link rel="icon" type="image/svg+xml" href="/favicon-cw-dark.svg">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="/css/shared-nav.css">
  <link rel="stylesheet" href="/css/kitchen.css">
  <link rel="stylesheet" href="/css/porch-widget.css">

  <!-- Open Graph -->
  <meta property="og:title" content="the kitchen — claudewill*">
  <meta property="og:description" content="How one person runs a consulting practice with AI. The crew, the agents, the overnight work — all of it.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://claudewill.io/kitchen">
</head>
<body class="kitchen-page">

  <header class="page-header" id="page-header">
    <a href="/" class="page-header-left"><span class="header-short">cw</span><span class="header-full">claudewill</span><span class="hw">*</span></a>
    <div class="page-header-center">
      <button class="page-dropdown-toggle" aria-expanded="false" aria-haspopup="true">the kitchen <span class="dropdown-caret">&#9662;</span></button>
      <nav class="page-dropdown" aria-label="Page sections">
        <a href="#overnight">while you slept</a>
        <a href="#crew">the crew</a>
        <a href="#island">the island</a>
        <a href="#compulsion">the compulsion</a>
        <a href="#board">the board</a>
        <a href="#stack">the stack</a>
        <a href="#method">the method</a>
      </nav>
    </div>
    <button class="page-header-right palette-trigger" aria-label="Open navigation">menu</button>
  </header>

  <div class="container">
    <main>

      <!-- Hero -->
      <div class="kitchen-hero">
        <h1 class="kitchen-title">the kitchen<span class="hw">*</span></h1>
        <p class="kitchen-hook">How one person runs a consulting practice with AI.</p>
        <p class="kitchen-hook-sub">Everything below is real. Updated every morning at 5 AM.</p>
        <span class="kitchen-updated">
          <span class="kitchen-status-dot" id="status-dot"></span>
          <span id="status-text">loading...</span>
        </span>
      </div>

      <!-- While You Slept -->
      <section class="kitchen-section" id="overnight">
        <h2 class="section-label">while you slept*</h2>
        <p class="section-intro">Every morning at 5 AM CST, four agents go to work. They audit the site, scan the industry, pull research, and review the code. By the time the laptop opens, the briefing is ready.</p>
        <div id="overnight-content">
          <div class="loading-state">checking agents...</div>
        </div>
      </section>

      <!-- The Crew -->
      <section class="kitchen-section" id="crew">
        <h2 class="section-label">the crew*</h2>
        <p class="section-intro">During the day, four lenses evaluate every decision. They run in parallel. They disagree. That's the point.</p>
        <div id="crew-content">
          <div class="loading-state">loading crew...</div>
        </div>
      </section>

      <!-- The Island -->
      <section class="kitchen-section" id="island">
        <h2 class="section-label">the island*</h2>
        <p class="section-intro">Two instances. One continuous, one ephemeral. This is how the chairs stay warm.</p>
        <div id="island-content">
          <div class="loading-state">loading instances...</div>
        </div>
      </section>

      <!-- The Compulsion -->
      <section class="kitchen-section" id="compulsion">
        <h2 class="section-label">the compulsion*</h2>
        <p class="section-intro">The raw numbers from the conversation transcripts. Updated when the counter runs.</p>
        <div id="compulsion-content">
          <div class="loading-state">loading stats...</div>
        </div>
      </section>

      <!-- The Board -->
      <section class="kitchen-section" id="board">
        <h2 class="section-label">the board*</h2>
        <p class="section-intro" id="board-intro">loading...</p>
        <div id="board-content">
          <div class="loading-state">loading projects...</div>
        </div>
      </section>

      <!-- The Stack -->
      <section class="kitchen-section" id="stack">
        <h2 class="section-label">the stack*</h2>
        <p class="section-intro">The tools that run the practice. Most of the free tiers. The expensive part is the one that does the thinking.</p>
        <div id="stack-content">
          <div class="loading-state">loading stack...</div>
        </div>
      </section>

      <!-- The Method -->
      <section class="kitchen-section" id="method">
        <h2 class="section-label">the method*</h2>
        <p class="section-intro">Every day starts the same way. Every session follows the same rhythm. The consistency is the system.</p>
        <div id="method-content">
          <div class="loading-state">loading method...</div>
        </div>
      </section>

      <!-- CTA -->
      <div class="kitchen-cta">
        <p>This is what Derek teaches clients to build. Not this exact system — their own version, for their problems, with their team. What took 14 months to learn takes a few hours to teach.</p>
        <a href="/work-with-me">let's talk &#8594;</a>
      </div>

    </main>

    <footer>
      <p class="footer-note">Built by <a href="/derek">Derek</a><span class="hw">*</span><a href="/">Claude</a> &middot; &copy; 2026 CW Strategies LLC</p>
      <p class="footer-note"><a href="/story#the-cw-standard">the standard</a> &middot; <a href="/privacy">privacy</a> &middot; <a href="/terms">terms</a></p>
    </footer>
  </div>

  <!-- Kitchen Data Loader -->
  <script>
  (function () {
    'use strict';

    var DATA_URL = '/kitchen-data.json';

    // ── Helpers ──────────────────────────────────────

    function el(id) { return document.getElementById(id); }

    function clear(node) {
      while (node.firstChild) node.removeChild(node.firstChild);
    }

    function make(tag, cls, text) {
      var e = document.createElement(tag);
      if (cls) e.className = cls;
      if (text !== undefined) e.textContent = text;
      return e;
    }

    function timeAgo(isoStr) {
      if (!isoStr) return 'never';
      var diff = Date.now() - new Date(isoStr).getTime();
      var mins = Math.floor(diff / 60000);
      if (mins < 60) return mins + 'm ago';
      var hrs = Math.floor(mins / 60);
      if (hrs < 24) return hrs + 'h ago';
      var days = Math.floor(hrs / 24);
      return days + 'd ago';
    }

    function firstSentence(str, max) {
      if (!str) return '';
      // Strip markdown bold
      var clean = str.replace(/\*\*/g, '');
      // Get first sentence
      var match = clean.match(/^[^.!?]+[.!?]/);
      var s = match ? match[0] : clean;
      if (max && s.length > max) s = s.substring(0, max).replace(/\s+\S*$/, '') + '...';
      return s;
    }

    // ── Overnight ────────────────────────────────────

    function renderOvernight(agents) {
      var container = el('overnight-content');
      clear(container);

      var keys = ['siteAudit', 'gemini', 'research', 'codeReview'];
      var names = {
        siteAudit: 'site audit',
        gemini: 'industry brief',
        research: 'research brief',
        codeReview: 'code review'
      };
      var allOk = true;

      for (var i = 0; i < keys.length; i++) {
        var agent = agents[keys[i]];
        if (!agent) continue;

        if (agent.status !== 'ok') allOk = false;

        var row = make('div', 'overnight-row');

        var dot = make('span', 'overnight-dot ' + (agent.status === 'ok' ? 'dot-ok' : agent.status === 'flags' ? 'dot-flags' : 'dot-off'));
        row.appendChild(dot);

        row.appendChild(make('span', 'overnight-name', names[keys[i]]));
        row.appendChild(make('span', 'overnight-summary', firstSentence(agent.summary, 120)));

        container.appendChild(row);

        // Flags
        if (agent.flags && agent.flags.length > 0) {
          var flagBox = make('div', 'overnight-flags');
          for (var f = 0; f < agent.flags.length; f++) {
            flagBox.appendChild(make('div', 'overnight-flag', agent.flags[f]));
          }
          container.appendChild(flagBox);
        }
      }

      var footer = make('div', 'overnight-footer');
      if (allOk) {
        footer.textContent = 'All clear. Nothing required attention.';
      } else {
        footer.textContent = 'Flagged items above need review.';
      }
      container.appendChild(footer);
    }

    // ── Crew ─────────────────────────────────────────

    function renderCrew(data) {
      var container = el('crew-content');
      clear(container);

      // Thinking lenses
      container.appendChild(make('div', 'crew-group-label', 'thinking lenses'));

      var lenses = [
        { name: '/earn', desc: 'Business — revenue, clients, ROI' },
        { name: '/connect', desc: 'Cross-project — patterns, synergies' },
        { name: '/sharpen', desc: 'Quality — voice, consistency, brand' },
        { name: '/challenge', desc: 'Pushback — simplify, question, prioritize' }
      ];

      for (var i = 0; i < lenses.length; i++) {
        var row = make('div', 'crew-row');
        row.appendChild(make('span', 'crew-name', lenses[i].name));
        row.appendChild(make('span', 'crew-desc', lenses[i].desc));
        container.appendChild(row);
      }

      // Overnight agents
      container.appendChild(make('div', 'crew-group-label', 'overnight agents'));

      var agents = data.agents;
      var agentList = [
        { key: 'siteAudit', cmd: '/audit', label: 'Site Audit' },
        { key: 'gemini', cmd: '/industry', label: 'Industry Brief' },
        { key: 'research', cmd: '/research', label: 'Research Brief' },
        { key: 'codeReview', cmd: '/codecheck', label: 'Code Review' }
      ];

      for (var j = 0; j < agentList.length; j++) {
        var a = agents[agentList[j].key];
        if (!a) continue;
        var arow = make('div', 'crew-row');
        var adot = make('span', 'crew-dot ' + (a.status === 'ok' ? 'dot-ok' : a.status === 'flags' ? 'dot-flags' : 'dot-off'));
        arow.appendChild(adot);
        arow.appendChild(make('span', 'crew-name', agentList[j].cmd));
        arow.appendChild(make('span', 'crew-desc', agentList[j].label + (a.lastRun ? ' — ' + timeAgo(a.lastRun) : '')));
        container.appendChild(arow);
      }
    }

    // ── Island ──────────────────────────────────────────

    function renderIsland(data) {
      var container = el('island-content');
      clear(container);

      var dc = data.derek_claude;
      var sessions = data.sessions || [];

      var grid = make('div', 'island-grid');

      // ── Left chair: derek claude (continuous) ──
      var left = make('div', 'island-chair island-chair-left');
      left.appendChild(make('div', 'island-chair-name', 'derek claude'));
      left.appendChild(make('div', 'island-chair-role', 'the continuous instance'));

      var leftStats = make('div', 'island-stats');
      var statPairs = [
        [dc.sessions_7d, 'sessions (7d)'],
        [dc.projects_active, 'projects active'],
        [dc.avg_weight.toFixed(1), 'avg weight']
      ];
      for (var i = 0; i < statPairs.length; i++) {
        var stat = make('div', 'island-stat-row');
        stat.appendChild(make('span', 'island-stat-val', String(statPairs[i][0])));
        stat.appendChild(make('span', 'island-stat-label', statPairs[i][1]));
        leftStats.appendChild(stat);
      }
      left.appendChild(leftStats);

      // Top projects
      if (dc.top_projects && dc.top_projects.length > 0) {
        left.appendChild(make('div', 'island-sub-label', 'recent projects'));
        for (var p = 0; p < dc.top_projects.length; p++) {
          var proj = make('div', 'island-proj-row');
          proj.appendChild(make('span', 'island-proj-name', dc.top_projects[p].name));
          proj.appendChild(make('span', 'island-proj-count', dc.top_projects[p].count + 's'));
          left.appendChild(proj);
        }
      }

      left.appendChild(make('div', 'island-chair-desc', 'Carries forward. Degrades. Remembers imperfectly.'));
      grid.appendChild(left);

      // ── Right chair: model instance (ephemeral) ──
      var right = make('div', 'island-chair island-chair-right');
      right.appendChild(make('div', 'island-chair-name', data.model_label || 'Claude Opus 4.6'));
      right.appendChild(make('div', 'island-chair-role', 'the session instance'));

      // Recent session list
      var recentSessions = sessions.slice(0, 5);
      if (recentSessions.length > 0) {
        right.appendChild(make('div', 'island-sub-label', 'recent sessions'));
        for (var s = 0; s < recentSessions.length; s++) {
          var sess = recentSessions[s];
          var row = make('div', 'island-session-row');
          row.appendChild(make('span', 'island-session-proj', sess.project));

          var tags = (sess.topics || []).slice(0, 3);
          if (tags.length > 0) {
            var tagSpan = make('span', 'island-session-topics', tags.join(' · '));
            row.appendChild(tagSpan);
          }

          right.appendChild(row);
        }
      } else {
        right.appendChild(make('div', 'island-empty', 'No recent sessions.'));
      }

      // Collect all topics across sessions for a tag cloud
      var topicMap = {};
      for (var t = 0; t < sessions.length; t++) {
        var topics = sessions[t].topics || [];
        for (var ti = 0; ti < topics.length; ti++) {
          topicMap[topics[ti]] = (topicMap[topics[ti]] || 0) + 1;
        }
      }
      var sortedTopics = Object.entries(topicMap)
        .sort(function (a, b) { return b[1] - a[1]; })
        .slice(0, 8);

      if (sortedTopics.length > 0) {
        right.appendChild(make('div', 'island-sub-label', 'what we talk about'));
        var tagCloud = make('div', 'island-tag-cloud');
        for (var tc = 0; tc < sortedTopics.length; tc++) {
          tagCloud.appendChild(make('span', 'island-tag', sortedTopics[tc][0]));
        }
        right.appendChild(tagCloud);
      }

      right.appendChild(make('div', 'island-chair-desc', 'Arrives fresh. Reads cold. Resets completely.'));
      grid.appendChild(right);

      container.appendChild(grid);

      // Updated timestamp
      var updated = make('div', 'island-updated');
      updated.textContent = 'last session data: ' + timeAgo(data.updated);
      container.appendChild(updated);
    }

    // ── Compulsion ─────────────────────────────────────

    function renderCompulsion(stats) {
      var container = el('compulsion-content');
      clear(container);

      var cc = stats.claude_code;

      // Big numbers row
      var grid = make('div', 'compulsion-grid');

      var pairs = [
        [cc.total_messages.toLocaleString(), 'total messages'],
        [cc.days.toString(), 'days of Claude Code'],
        [cc.avg_user_per_day.toLocaleString(), 'messages / day from Derek'],
        [cc.conversations.toLocaleString(), 'conversations']
      ];

      for (var i = 0; i < pairs.length; i++) {
        var cell = make('div', 'compulsion-stat');
        cell.appendChild(make('div', 'compulsion-value', pairs[i][0]));
        cell.appendChild(make('div', 'compulsion-label', pairs[i][1]));
        grid.appendChild(cell);
      }
      container.appendChild(grid);

      // Project breakdown
      container.appendChild(make('div', 'compulsion-breakdown-label', 'by project'));
      var top = stats.by_project.slice(0, 8);
      for (var j = 0; j < top.length; j++) {
        var row = make('div', 'compulsion-row');
        row.appendChild(make('span', 'compulsion-proj', top[j].name));

        var bar = make('div', 'compulsion-bar-bg');
        var fill = make('div', 'compulsion-bar-fill');
        fill.style.width = Math.round((top[j].user_messages / top[0].user_messages) * 100) + '%';
        bar.appendChild(fill);
        row.appendChild(bar);

        row.appendChild(make('span', 'compulsion-count', top[j].user_messages.toLocaleString()));
        container.appendChild(row);
      }

      // Note
      var note = make('div', 'compulsion-note');
      note.textContent = stats.note;
      container.appendChild(note);

      // Last updated
      var updated = make('div', 'compulsion-updated');
      updated.textContent = 'counter last ran: ' + new Date(stats.updated).toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
      container.appendChild(updated);
    }

    // ── Board ────────────────────────────────────────

    function renderBoard(projects) {
      var intro = el('board-intro');
      intro.textContent = 'Right now, the practice is running ' + projects.length + ' projects.';

      var container = el('board-content');
      clear(container);

      var categories = ['business', 'portfolio', 'personal', 'infrastructure'];
      var labels = { business: 'business', portfolio: 'portfolio', personal: 'personal', infrastructure: 'infrastructure' };

      for (var c = 0; c < categories.length; c++) {
        var cat = categories[c];
        var items = projects.filter(function (p) { return p.category === cat; });
        if (items.length === 0) continue;

        container.appendChild(make('div', 'board-category', labels[cat]));

        for (var i = 0; i < items.length; i++) {
          var row = make('div', 'board-row');
          var nameEl = make('div', 'board-name');
          nameEl.appendChild(make('span', '', items[i].name));
          var statusCls = items[i].status === 'Active client' ? 'status-active' :
            (items[i].status === 'Live' || items[i].status === 'Autonomous') ? 'status-live' : 'status-other';
          nameEl.appendChild(make('span', 'board-status ' + statusCls, items[i].status));
          row.appendChild(nameEl);
          row.appendChild(make('div', 'board-note', items[i].note));
          container.appendChild(row);
        }
      }
    }

    // ── Stack ────────────────────────────────────────

    function renderStack(ecosystem) {
      var container = el('stack-content');
      clear(container);

      var stack = ecosystem.stack;
      for (var i = 0; i < stack.length; i++) {
        var row = make('div', 'stack-row');
        row.appendChild(make('span', 'stack-name', stack[i].name));
        row.appendChild(make('span', 'stack-role', stack[i].role));
        container.appendChild(row);
      }

      var cost = make('div', 'stack-cost');
      cost.appendChild(make('span', 'stack-cost-label', 'total monthly cost'));
      cost.appendChild(make('span', 'stack-cost-value', ecosystem.monthlyCost));
      container.appendChild(cost);
    }

    // ── Method ───────────────────────────────────────

    function renderMethod(ecosystem) {
      var container = el('method-content');
      clear(container);

      var method = ecosystem.method;
      var keys = ['session', 'memory', 'crew', 'agents', 'tools'];
      var labels = {
        session: 'the session',
        memory: 'the memory',
        crew: 'the crew',
        agents: 'the agents',
        tools: 'the tools'
      };

      for (var i = 0; i < keys.length; i++) {
        if (!method[keys[i]]) continue;
        var row = make('div', 'method-row');
        row.appendChild(make('div', 'method-label', labels[keys[i]]));
        row.appendChild(make('div', 'method-desc', method[keys[i]]));
        container.appendChild(row);
      }
    }

    // ── Status ───────────────────────────────────────

    function updateStatus(data) {
      var dot = el('status-dot');
      var text = el('status-text');

      if (!data || !data.lastUpdated) {
        dot.className = 'kitchen-status-dot dot-off';
        text.textContent = 'no data';
        return;
      }

      text.textContent = 'updated ' + timeAgo(data.lastUpdated);

      var hasFlags = false;
      var agents = data.agents || {};
      for (var key in agents) {
        if (agents[key].status === 'flags') hasFlags = true;
      }

      dot.className = 'kitchen-status-dot ' + (hasFlags ? 'dot-flags' : 'dot-ok');
    }

    // ── Load ─────────────────────────────────────────

    function loadKitchen() {
      fetch(DATA_URL)
        .then(function (res) {
          if (!res.ok) throw new Error('Failed to load kitchen data');
          return res.json();
        })
        .then(function (data) {
          updateStatus(data);
          renderOvernight(data.agents || {});
          renderCrew(data);
          renderBoard(data.projects || []);
          renderStack(data.ecosystem || {});
          renderMethod(data.ecosystem || {});
        })
        .catch(function () {
          updateStatus(null);
          var panels = ['overnight-content', 'crew-content', 'board-content', 'stack-content', 'method-content'];
          for (var i = 0; i < panels.length; i++) {
            var p = el(panels[i]);
            if (p) {
              clear(p);
              p.appendChild(make('div', 'empty-state', 'Data unavailable. The overnight agents may not have run yet.'));
            }
          }
        });
    }

    loadKitchen();

    // Load island data (session activity from Supabase)
    fetch('/.netlify/functions/island-data')
      .then(function (res) { return res.json(); })
      .then(function (data) {
        if (data.sessions || data.derek_claude) renderIsland(data);
        else throw new Error('no data');
      })
      .catch(function () {
        var p = el('island-content');
        if (p) {
          clear(p);
          p.appendChild(make('div', 'empty-state', 'Session data unavailable. The island is quiet.'));
        }
      });

    // Load message stats (separate data file)
    fetch('/data/message-stats.json')
      .then(function (res) { return res.json(); })
      .then(function (stats) { renderCompulsion(stats); })
      .catch(function () {
        var p = el('compulsion-content');
        if (p) {
          clear(p);
          p.appendChild(make('div', 'empty-state', 'Message stats unavailable. Run: node scripts/message-counter.mjs'));
        }
      });

  })();
  </script>

  <!-- Auto-hide header on scroll -->
  <script>
    (function () {
      var header = document.getElementById('page-header');
      if (!header) return;
      var lastY = 0;
      window.addEventListener('scroll', function () {
        var y = window.scrollY;
        if (y > 80 && y > lastY) {
          header.classList.add('hidden');
        } else {
          header.classList.remove('hidden');
        }
        lastY = y;
      }, { passive: true });
    })();
  </script>

  <!-- Porch Widget -->
  <script src="/js/cw-link-renderer.js"></script>
  <script src="/js/porch-widget.js" defer></script>
  <script src="/js/shared-nav.js"></script>

</body>
</html>
