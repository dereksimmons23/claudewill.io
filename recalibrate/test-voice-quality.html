<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voice Quality Test - Recalibrate</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
        .voice-option { background: #f5f5f5; padding: 15px; margin: 10px 0; border-radius: 6px; }
        button { background: #2c5aa0; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #1d3f73; }
        .test-text { background: #e7f3ff; padding: 15px; border-radius: 6px; margin: 15px 0; }
        select { padding: 8px; margin: 10px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>üé§ Voice Quality Test</h1>
    
    <div class="test-text">
        <h3>Test Text:</h3>
        <p><strong>"Perfect! Nice to meet you, Derek. I've added your company to your r√©sum√©. Creating your professional P D F now!"</strong></p>
    </div>

    <div>
        <h3>Available Voices:</h3>
        <select id="voiceSelect">
            <option value="">Loading voices...</option>
        </select>
        <button onclick="testSelectedVoice()">üé§ Test Selected Voice</button>
        <button onclick="testAllVoices()">üéµ Test All Voices</button>
    </div>

    <div id="voiceList"></div>

    <script>
        let voices = [];
        let synthesis = window.speechSynthesis;

        function loadVoices() {
            voices = synthesis.getVoices();
            const select = document.getElementById('voiceSelect');
            const voiceList = document.getElementById('voiceList');
            
            select.innerHTML = '';
            voiceList.innerHTML = '';
            
            if (voices.length === 0) {
                select.innerHTML = '<option value="">No voices available</option>';
                return;
            }

            // Populate select dropdown
            voices.forEach((voice, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `${voice.name} (${voice.lang})`;
                select.appendChild(option);
            });

            // Show voice details
            const englishVoices = voices.filter(v => v.lang.startsWith('en'));
            voiceList.innerHTML = `
                <h3>English Voices (${englishVoices.length} available):</h3>
                ${englishVoices.map((voice, index) => `
                    <div class="voice-option">
                        <strong>${voice.name}</strong> (${voice.lang})
                        ${voice.localService ? '‚úÖ Local' : 'üåê Remote'}
                        ${voice.default ? '‚≠ê Default' : ''}
                        <button onclick="testVoice(${voices.indexOf(voice)})">Test</button>
                    </div>
                `).join('')}
            `;

            console.log('üé§ Available voices:', voices.map(v => `${v.name} (${v.lang})`));
        }

        function testVoice(index) {
            const voice = voices[index];
            const utterance = new SpeechSynthesisUtterance("Perfect! Nice to meet you, Derek. I've added your company to your r√©sum√©. Creating your professional P D F now!");
            
            utterance.voice = voice;
            utterance.rate = 1.2;
            utterance.pitch = 0.9;
            utterance.volume = 0.8;
            
            console.log(`üé§ Testing voice: ${voice.name}`);
            synthesis.speak(utterance);
        }

        function testSelectedVoice() {
            const select = document.getElementById('voiceSelect');
            const index = parseInt(select.value);
            if (!isNaN(index)) {
                testVoice(index);
            }
        }

        function testAllVoices() {
            const englishVoices = voices.filter(v => v.lang.startsWith('en'));
            let currentIndex = 0;

            function testNext() {
                if (currentIndex < englishVoices.length) {
                    const voice = englishVoices[currentIndex];
                    console.log(`Testing voice ${currentIndex + 1}/${englishVoices.length}: ${voice.name}`);
                    
                    const utterance = new SpeechSynthesisUtterance(`Voice ${currentIndex + 1}: ${voice.name}. Perfect! Nice to meet you, Derek.`);
                    utterance.voice = voice;
                    utterance.rate = 1.2;
                    utterance.pitch = 0.9;
                    utterance.volume = 0.8;
                    
                    utterance.onend = () => {
                        setTimeout(() => {
                            currentIndex++;
                            testNext();
                        }, 1000);
                    };
                    
                    synthesis.speak(utterance);
                }
            }
            
            testNext();
        }

        // Load voices when they're available
        if (synthesis.onvoiceschanged !== undefined) {
            synthesis.onvoiceschanged = loadVoices;
        }
        
        // Also try loading immediately
        setTimeout(loadVoices, 100);
        setTimeout(loadVoices, 1000); // Fallback
    </script>
</body>
</html>
